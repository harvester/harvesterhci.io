---
title: 'CVE-2025-1974: ingress-nginx admission controller RCE escalation'
description: 'This article describes the mitigation steps for the CVE-2025-1974 vulnerability in Harvester.'
authors:
  - name: Ivan Sim
    title: Principal Software Engineer
    url: https://github.com/ihcsim
    image_url: https://github.com/ihcsim.png
tags: [security, cve]
hide_table_of_contents: false
---

:::warning

**CVE-2025-1974** (vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) has a score of [9.8 (Critical)](https://www.first.org/cvss/calculator/3-1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

The vulnerability affects specific versions of the RKE2 ingress-nginx controller (v.1.11.4 and earlier, and v1.12.0). All Harvester versions that use this controller (including v1.4.2 and later) are therefore affected.

:::

A security issue was discovered in Kubernetes where under certain conditions, an unauthenticated attacker with access to the pod network can achieve arbitrary code execution in the context of the ingress-nginx controller. This can lead to disclosure of secrets accessible to the controller. (Note that in the default installation, the controller can access all secrets cluster-wide.)

Your Harvester cluster is affected by this vulnerability if:

- the RKE2 ingress-nginx controller is installed, and
- the pods are running version v1.12.0 or all versions prior to v1.11.4 (included)

You can confirm the version of the RKE2 ingress-nginx pods by running this command on your Harvester cluster:

```sh
kubectl -n kube-system get po -l"app.kubernetes.io/name=rke2-ingress-nginx" -ojsonpath='{.items[].spec.containers[].image}'
```

If the command returns one of the affected versions, disable the `rke2-ingress-nginx-admission` validating webhook configuration by performing the following steps:

1. On one of your control plane nodes, create the file `/var/lib/rancher/rke2/server/manifests/rke2-ingress-nginx-config.yaml`.

1. Add the following content to the file:

  ```yaml
  apiVersion: helm.cattle.io/v1
  kind: HelmChartConfig
  metadata:
    name: rke2-ingress-nginx
    namespace: kube-system
  spec:
    valuesContent: |-
      controller:
        admissionWebhooks:
          enabled: false
        extraArgs:
          enable-annotation-validation: true
  ```

    Harvester automatically applies the change once the content is saved.

RKE2 deletes the `rke2-ingress-nginx-admission` validating webhook configuration and restarts the ingress-nginx pods.

Once your Harvester cluster receives the RKE2 ingress-nginx patch, you can re-install the `rke2-ingress-nginx-admission` validating webhook configuration by removing the `HelmChartConfig` workaround.

:::info important

These steps only cover the RKE2 ingress-nginx controller that is managed by Harvester. You must also update other running ingress-nginx controllers. See the References section for more information.

:::

## References

- https://nvd.nist.gov/vuln/detail/CVE-2025-1974
- https://github.com/kubernetes/kubernetes/issues/131009
- https://github.com/rancher/rke2/issues/7953
- https://www.suse.com/support/kb/doc/?id=000021756
